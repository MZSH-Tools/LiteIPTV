# LiteIPTV 设计文档

## 项目目标

为国内用户（尤其老年人）提供精简、稳定的 CCTV 直播源。

## 核心功能

| 功能 | 说明 | 状态 |
|------|------|------|
| 抓取 | 从多个上游源获取 IPTV 直播地址 | [ ] |
| 筛选 | 只保留 CCTV 频道（1-17 + 5+），分离 IPv4/IPv6 地址 | [ ] |
| 测速 | 多轮测速，综合评估选择最稳定的源 | [ ] |
| 输出 | 生成 `ipv4.m3u` 和 `ipv6.m3u` 两个文件 | [ ] |
| 自动更新 | 定时运行，保持源的有效性 | [ ] |

## 频道范围

CCTV-1 至 CCTV-17，共 18 个频道：

- CCTV-1 综合
- CCTV-2 财经
- CCTV-3 综艺
- CCTV-4 中文国际
- CCTV-5 体育
- CCTV-5+ 体育赛事
- CCTV-6 电影
- CCTV-7 国防军事
- CCTV-8 电视剧
- CCTV-9 纪录
- CCTV-10 科教
- CCTV-11 戏曲
- CCTV-12 社会与法
- CCTV-13 新闻
- CCTV-14 少儿
- CCTV-15 音乐
- CCTV-16 奥林匹克
- CCTV-17 农业农村

## 上游源

上游源配置存放在 `config.json` 中，不公开。

## 输出格式

```m3u
#EXTM3U x-tvg-url="https://epg.112114.xyz/pp.xml"
#EXTINF:-1 tvg-name="CCTV1" tvg-logo="https://live.fanmingming.cn/tv/CCTV1.png" group-title="央视频道",CCTV-1 综合
http://xxx.m3u8
...
```

## 运行环境

- **设备**：Mac Mini（国内公网 IP）
- **定时任务**：launchd，每小时运行一次
- **自动部署**：仅在源发生变化时 git push

## 测速策略

- 每次运行进行 5 轮测速
- 每轮间隔 1 分钟
- 综合评估：响应时间、稳定性、成功率
- 每个频道保留综合得分最高的源

## 提交策略

- 对比新旧 m3u 文件内容
- 仅在源地址发生变化时提交
- commit 信息格式：`update: YYYY-MM-DD HH:mm`

## 输出文件

| 文件 | 说明 |
|------|------|
| `ipv4.m3u` | IPv4 源 |
| `ipv6.m3u` | IPv6 源 |

## 用户访问

- **托管方式**：GitHub 仓库 + 国内中转
- **访问地址**（通过中转加速）：
  - `https://mirror.ghproxy.com/https://raw.githubusercontent.com/MZSH-Tools/LiteIPTV/main/ipv4.m3u`
  - `https://mirror.ghproxy.com/https://raw.githubusercontent.com/MZSH-Tools/LiteIPTV/main/ipv6.m3u`
- **备用中转**：ghfast.top、gh-proxy.com、ghproxy.net

## 技术栈

（待定）

## 开发进度

- [x] 项目初始化
- [ ] 抓取模块
- [ ] 筛选模块
- [ ] 测速模块
- [ ] 输出模块
- [ ] 定时任务配置
